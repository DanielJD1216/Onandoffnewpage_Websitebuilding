# 배포 가이드 - 온앤오프 유학원 웹사이트

이 가이드는 웹사이트를 프로덕션에 배포하는 방법을 설명합니다. **Vercel**을 권장하며, Next.js와 최상의 호환성을 제공합니다.

## 사전 준비사항

배포하기 전에 다음을 확인하세요:
- ✅ 웹사이트가 로컬에서 작동함 (`npm run dev`)
- ✅ 모든 환경 변수가 설정됨
- ✅ GitHub 저장소에 접근 가능
- ✅ 커스텀 도메인 있음 (선택 사항, Vercel 무료 도메인 사용 가능)

## 권장: Vercel에 배포

Vercel은 Next.js를 만든 회사로 최상의 경험을 제공합니다.

### Vercel을 선택하는 이유?

- ✅ **무료 플랜**이 관대함 (이 사이트에 완벽)
- ✅ **자동 배포** GitHub에서
- ✅ **내장 CDN** 빠른 글로벌 접근
- ✅ **쉬운 환경 변수** 관리
- ✅ **자동 HTTPS** 인증서
- ✅ **제로 설정** Next.js에 필요 없음

### 단계별 배포

#### 1. GitHub에 코드 푸시

```bash
cd MAIN

# 모든 변경사항이 커밋되었는지 확인
git add .
git commit -m "배포 준비"
git push origin main
```

#### 2. Vercel 계정 생성

1. [vercel.com](https://vercel.com)으로 이동
2. "Sign Up" 클릭
3. **GitHub으로 가입** (권장 - 배포가 더 쉬움)

#### 3. 프로젝트 Import

1. 로그인 후 "Add New" → "Project" 클릭
2. "Import Git Repository" 선택
3. 저장소를 찾아 "Import" 클릭
4. Vercel이 자동으로 Next.js 프로젝트 감지

#### 4. 프로젝트 설정 구성

**Framework Preset**: Next.js (자동 감지)
**Root Directory**: `./MAIN` (또는 저장소 루트가 MAIN이면 `.`)
**Build Command**: `npm run build` (자동 입력)
**Output Directory**: `.next` (자동 입력)

"Deploy" 클릭!

#### 5. 환경 변수 추가 (필요한 경우)

프로덕션용 환경 변수가 있으면:

1. 프로젝트 설정 → Environment Variables로 이동
2. **모든** 변수를 `.env.local`에서 추가:

```bash
# 애플리케이션
NEXT_PUBLIC_APP_URL=https://yourdomain.com  # 실제 도메인

# 추가 서비스가 있으면 여기에 추가
```

**중요**:
- 프로덕션 환경에 `NEXT_PUBLIC_APP_URL`을 실제 도메인으로 설정
- 모든 변수에 대해 "Production" 환경 선택

#### 6. 재배포

환경 변수 추가 후:
1. "Deployments" 탭으로 이동
2. 최신 배포에서 점 세 개 (...) 클릭
3. "Redeploy" 클릭
4. "Use existing Build Cache" 체크 해제
5. "Redeploy" 클릭

사이트가 성공적으로 배포됩니다!

#### 7. 커스텀 도메인 구성 (선택 사항)

`onoffstudyabroad.com` 같은 커스텀 도메인이 있으면:

1. 프로젝트 → Settings → Domains로 이동
2. 도메인 이름 입력
3. Vercel이 추가할 DNS 레코드 표시
4. 도메인 제공업체(GoDaddy, Namecheap 등)로 이동
5. Vercel이 표시한 DNS 레코드 추가
6. DNS 전파 대기 (24-48시간)
7. Vercel이 자동으로 SSL 인증서 제공

**무료 Vercel 도메인**: 도메인이 없으면 무료로 사용 가능: `your-project.vercel.app`

#### 8. Squarespace 도메인 연결

이미 Squarespace에 도메인이 있으면:

1. Squarespace 계정에 로그인
2. Settings → Domains로 이동
3. 도메인 선택
4. DNS Settings 클릭
5. Vercel이 제공한 레코드 추가:
   - Type: A Record, Host: @, Value: `76.76.21.21`
   - Type: CNAME, Host: www, Value: `cname.vercel-dns.com`
6. 저장하고 전파 대기

### 자동 배포

Vercel은 GitHub에 푸시할 때 자동 배포:
- `main` 브랜치에 푸시 → 프로덕션 배포
- 다른 브랜치에 푸시 → 미리보기 배포 생성

## 프로덕션 체크리스트

라이브 전에 확인:

### 기능
- [ ] 한국어 (`/ko`) 사이트 작동
- [ ] 이미지가 올바르게 로드
- [ ] 모든 링크 작동 (404 오류 없음)
- [ ] 모바일 뷰가 올바르게 작동

### 성능
- [ ] Lighthouse 감사 실행 (90+ 점수 목표)
- [ ] 모바일에서 로딩 속도 테스트
- [ ] 이미지 최적화됨

### SEO
- [ ] 모든 페이지에 메타 설명 설정
- [ ] 소셜 미디어 미리보기 이미지 작동

### 서비스
- [ ] Vercel 프로덕션 URL 구성됨
- [ ] 커스텀 도메인 작동 (해당되는 경우)

## 배포 후 모니터링

### 1. 에러 추적 설정 (선택 사항이지만 권장)

Vercel의 내장 분석 사용:

무료로 자동 포함됨!

### 2. 성능 모니터링

- Vercel Analytics 사용 (무료, 내장)

### 3. 로그 확인

Vercel 대시보드에서 로그 보기:
- 프로젝트 → Logs로 이동
- 에러로 필터
- 배포 후 문제 확인

## 라이브 사이트 업데이트

### 방법 1: 자동 (권장)

GitHub에 푸시만 하면 됨:
```bash
git add .
git commit -m "콘텐츠 업데이트"
git push origin main
```

Vercel이 자동으로 푸시를 감지하고 재배포 (2-3분 소요).

### 방법 2: 수동 재배포

Vercel 대시보드에서:
1. Deployments로 이동
2. 아무 배포에서 "..." 클릭
3. "Redeploy" 클릭

## 이전 버전으로 롤백

문제가 발생하면:

1. Vercel 대시보드 → Deployments로 이동
2. 작동하는 이전 배포 찾기
3. "..." → "Promote to Production" 클릭

사이트가 즉시 해당 버전으로 복구됩니다!

## 일반적인 배포 문제

### "모듈을 찾을 수 없음"으로 빌드 실패

**해결**: 모든 의존성이 `devDependencies`가 아닌 `package.json`의 `dependencies`에 있는지 확인.

```bash
# devDependencies에서 dependencies로 패키지 이동
npm install package-name --save
```

### 환경 변수가 작동하지 않음

**해결**:
1. Vercel에서 철자와 값 확인
2. "Production" 환경을 선택했는지 확인
3. 변수 추가 후 재배포

### 이미지가 로드되지 않음

**해결**: `next.config.js`에 올바른 이미지 도메인이 있는지 확인:

```javascript
images: {
  domains: ['yourdomain.com'],
}
```

### 페이지 새로고침 시 404 에러

**해결**: Vercel에서는 발생하지 않아야 하지만, 발생하면:
- `next.config.js` 구성 확인
- Vercel이 "Next.js" 프레임워크 프리셋으로 설정되었는지 확인

## 비용 분석

### 무료 플랜 (이 사이트에 완벽)

**Vercel 무료**:
- ✅ 무제한 배포
- ✅ 월 100GB 대역폭
- ✅ 자동 HTTPS
- ✅ 커스텀 도메인
- ✅ 대부분의 소규모 비즈니스에 적합

### 업그레이드가 필요한 시기

아마 업그레이드할 필요 없지만, 필요하면:

- **Vercel Pro** ($20/월): 트래픽이 100GB/월을 초과하는 경우

## 배포 후 지원

### 클라이언트용

다음 URL을 클라이언트와 공유:
- **라이브 웹사이트**: https://yourdomain.com
- **Vercel 대시보드**: https://vercel.com (배포 로그용)

### 향후 개발자용

다음 개발자가 접근할 수 있는지 확인:
1. GitHub 저장소
2. Vercel 계정 (팀원으로 추가)
3. 도메인 등록기관 (커스텀 도메인인 경우)

---

**배포 완료?** 이제 [유지보수-가이드.md](./유지보수-가이드.md)를 읽고 콘텐츠 업데이트 및 사이트 관리 방법을 배우세요!
